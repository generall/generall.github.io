<!DOCTYPE html>
<html>
<head>
  <title>Blog</title>
  <link rel="stylesheet" media="all" href="/assets/application.css" data-turbolinks-track="true" />
<link rel="stylesheet" media="all" href="https://fonts.googleapis.com/css?family=Roboto:400,400italic,700,300italic,300" data-turbolinks-track="true" />
  <link rel="stylesheet" media="all" href="/assets/application.css" data-turbolinks-track="true" />
<link rel="stylesheet" media="all" href="https://fonts.googleapis.com/css?family=Anonymous+Pro&amp;subset=latin-ext,cyrillic" data-turbolinks-track="true" />
  <link rel="stylesheet" media="all" href="/assets/application.css" data-turbolinks-track="true" />
  <link rel="stylesheet" media="all" href="/assets/application.css" data-turbolinks-track="true" />
<link rel="stylesheet" media="all" href="/assets/records.css" data-turbolinks-track="true" />
  <script type="text/javascript" src="http://vk.com/js/api/share.js?90" charset="windows-1251"></script>
  <!--%= javascript_include_tag 'application', 'data-turbolinks-track' => true %-->
  <script src="/assets/application.js" data-turbolinks-track="true"></script>
<script src="/assets/records.js" data-turbolinks-track="true"></script>
  <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="w+Uptyto2H7KSj1VA0rOzhTUbnLmDWhnhr/YgoWSv3rvelu1LAKKA4I4sSI/zQ264GXUWHLllsPqma7Hxs9PxA==" />
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
</head>
<body>


<div class="toTop"></div> 
<div class="wrapper">
  <header id="header" class="js-header">
    <a href="/cat/Machine_Learning.html" class="category fancybox.ajax">Machine Learning</a>
    <p class="logo">Structured kNN</p>
    <a href="/" class="tomain">Главная</a>
  </header>
  <div class="content">
    <article class="post">
      <h1>Метрический алгоритм разметки последовательностей</h1>

<p>Среди задач машинного обучения существует группа задач так называемой разметки последовательностей (sequence labeling).
Суть этих задач заключается в проставлении метки каждому элементу последовательности. 
При этом метка может зависеть не только от самого элемента, но и, в общем случае, от всех остальных элементов последовательности.</p>

<p>Для решения таких задач, в зависимости от способа описания элементов, можно использовать один из существующих алгоритмов.
Например, если в последовательности встречаются только элементы, принадлежащие конечному множеству элементов, то для решения такой задачи подойдут Скрытые Марковские Модели (HMM).
Если элемент можно описать в виде вектора действительных чисел, - подойдут Рекуррентные Нейронные Сети (RNN) или Случайные Условные Поля (CRF).</p>

<p>Однако, в том случае, когда элемент последовательности описывается более сложной структурой (деревом, множеством, графов и т.п.), применение указанных методов существенно усложняется.
В некоторых случаях элемент последовательности может быть описан не явно, а похожестью или расстоянием до других элементов.</p>

<p>Примером таких элементов могут служить концепты - понятия, смысловые значения имён или названий, встречающихся в текстах.
В качестве идентификатора концепта, например, может выступать URL Википедии, а описанием концепта - статья, находящаяся по ссылке.</p>

<p><img src="/img/concept.png" alt="Concept example" title="Concept example"></p>

<p>Довольно сложно предложить численное описание какого-либо концепта, однако способов сравнить их между собой довольно много.
Например можно посчитать число общих слов в статьях, описывающих два сравниваемых концепта.</p>

<p>Среди алгоритмов машинного обучения известны такие, которые в качестве входных дынных используют расстояния между классифицируемыми объектами.
Такие алгоритмы называют метрическими, среди них, например, существует алгоритм а k-nearest neighbours.</p>

<p>Напрямую, однако, применить kNN напрямую к последовательности элементов не получится, алгоритм не имеет возможности сохранить информацию о контексте.
Для применения метрических алгоритмов к последовательности данных рассмотрим способ обобщения алгоритма kNN.</p>

<p>Введем понятие состояния по аналогии с тем, как это сделано в алгоритме HMM с той лишь разницей, что переход между состояниями осуществляется не в наиболее вероятное состояние, а в состояние, элементы которого оказались ближе к текущему классифицируемому.</p>

<p>Рассмотрим для наглядности анимацию классификации точек на плоскости:</p>

<div class="sknn_animation">

<a href="/data/viz.json"></a>
<a href="/data/graph.json"></a>
</div>

<script src="/js/force.js" type="text/javascript"></script>

<p>Показанный процесс соответствует жадному методу классификации: он минимизирует расстояние лишь на каждом отдельном шаге.
Для более точной классификации необходимо минимизировать суммарное расстояние классификации всех элементов последовательности.</p>

<p>По аналогии с HMM, в модифицированном алгоритме kNN (будем называть его Structured kNN, SkNN) используется модифицированный алгоритм Витерби, отличающий от оригинального тем, что вместо максимизации произведения вероятностей производится минимизация суммарного расстояния.</p>

<p>Алгоритм SkNN может быть использован не только для разметки элементов последовательностей, но и для классификации последовательностей в целом.
Для этого, в прочем, все равно необходимо указать класс каждого отдельного элемента последовательности, но этот процесс может быть выполнен автоматически с помощью кластеризации.</p>

<p>Для классификации последовательностей необходимо сформировать граф состояний отдельно для каждого класса, а затем объединить их в один способом, показанным на рисунке:</p>

<p><img src="/img/sknn_class.png" alt="Classification with SkNN" title="Classification with SkNN"></p>

<p>После запуска алгоритма на тестовой последовательности, ее класс можно будет определить в соответствии с тем, состояния какой из ветвей графа были использованы для разметки.</p>

<p>В настоящее время я веду провожу попытки применить алгоритм SkNN для решения задачи Named Entity Linking,
и уже накопилось много интересного материала. Надеюсь в скором времени здесь появятся заметки об использовании DBpedia совместно с SkNN и обогащении датасета для решения задачи NEL.</p>

<h2>Больше о SkNN</h2>

<ul>
<li><a href="https://arxiv.org/abs/1610.04718">Generalization of metric classification algorithms for sequences classification and labelling</a> on arXiv.org [English]</li>
<li><a href="/sknn.pdf">Статья</a> на русском. </li>
<li>OpenSource реализация на Github

<ul>
<li><a href="https://github.com/generall/sknn-scala">Scala</a></li>
<li><a href="https://github.com/generall/SkNN-ruby">Ruby</a></li>
<li><a href="https://github.com/generall/SkNN-java">java, weka</a></li>
</ul></li>
</ul>

    </article>
    <div class="tags">
      <a class="tag btn-dark btn-border-o" href="/tag/Machine_Learning.html">Machine Learning</a>
      <a class="tag btn-dark btn-border-o" href="/tag/Sequence_classification.html">Sequence classification</a>
      <a class="tag btn-dark btn-border-o" href="/tag/NLP.html">NLP</a>
    </div>
    <div class="soc-btns">
      <!-- vk -->
      <div class="s-btn" id="vkshare">

      </div>
      <!-- twitter -->
      <div class="s-btn" id="tweet">
        <a href="https://twitter.com/share" class="twitter-share-button" data-via="_trean_" data-hashtags="comprehension.ml">Tweet</a>
      </div>
    </div>
    <div class="commentoza">
      <div id="disqus_thread"></div>
      <script>
(function() {  // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = '//comprehensionml.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>	
    </div>
  </div>
  <footer id="footer">
    <section class="follow-me">
      <a href="https://github.com/generall" class="g-hub" target="_blank"></a> 
      <a href="https://twitter.com/vasnetsov93" class="twitter" target="_blank"></a>
      <a href="https://ru.linkedin.com/in/андрей-васнецов-75268897" class="linkedin" target="_blank"></a> 
    </section>
    <section class="f-logo">
      <img src="/assets/logo.png" alt="">
    </section>
    <section class="copy"><a href="about.html">Андрей Васнецов</a> &copy; 2016</section>
  </footer> 
</div>


</body>
</html>
